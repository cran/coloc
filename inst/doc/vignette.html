<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Chris Wallace" />

<meta name="date" content="2019-05-17" />

<title>Coloc: a package for colocalisation analyses</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Coloc: a package for colocalisation analyses</h1>
<h4 class="author">Chris Wallace</h4>
<h4 class="date">2019-05-17</h4>



<div id="table-of-contents" class="section level1">
<h1>Table of Contents</h1>
<ol style="list-style-type: decimal">
<li><a href="#org63a948f">A brief outline of colocalisation analysis</a></li>
<li><a href="#orgfa90150">Usage</a></li>
<li><a href="#org953546b">An aside: fine mapping under a single causal variant assumption</a></li>
<li><a href="#org6973f37">(Approximate) Bayes Factor colocalisation analyses</a>
<ol style="list-style-type: decimal">
<li><a href="#org192e16b">Introduction</a></li>
<li><a href="#orgb0fa807">The basic <code>coloc.abf</code> function</a></li>
</ol></li>
<li><a href="#org3e7ddb9">Proportional testing</a>
<ol style="list-style-type: decimal">
<li><a href="#orgb852386">Using Bayes Factors to compare specific values of <span class="math inline">\(\eta\)</span></a></li>
</ol></li>
<li><a href="#org6244015">The difference between proportional and ABF approaches</a></li>
</ol>
<p><a id="org63a948f"></a></p>
</div>
<div id="a-brief-outline-of-colocalisation-analysis" class="section level1">
<h1>A brief outline of colocalisation analysis</h1>
<p>The coloc package can be used to perform genetic colocalisation analysis of two potentially related phenotypes, to ask whether they share common genetic causal variant(s) in a given region. There are a few key references which this vignette will not duplicate (see below), but, in brief, two approaches are implemented.</p>
<p>First, the proportional approach uses the fact that for two traits sharing causal variants, regression coefficients for either trait against any set of SNPs in the neighbourhood of those variants must be proportional. This test was first proposed by Plagnol et al. <sup><a id="fnr.1" class="footref" href="#fn.1">1</a></sup> in the context of evaluating whether expression of the gene <em>RPS26</em> mediated the association of type 1 diabetes to a region on chromosome 12q13 as had recently been proposed. The test addressed a common issue in genetics, and meant researchers could avoid the need to squint at parallel manhattan plots to decide whether two traits share causal variants. The function <code>coloc.test()</code> in this package evolved from code released by Vincent, but no longer available.</p>
<p>However, choosing <strong>which</strong> SNPs to use for the test is a problem. The obvious choice is to use those most strongly associated with one or other trait to maximise information, but doing so induces bias in the regression coefficients, which in turn leads to increased likelihood of spuriously rejecting the null of colocalisation, ie a quite substantially increased type 1 error rate <sup><a id="fnr.2" class="footref" href="#fn.2">2</a></sup>. I proposed two alternatives to address this problem, either using a principal component summary of genetic variation in the region to overcome the need to select a small set of test SNPs, implemented in <code>coloc.pcs()</code> and associated functions, or to use the ideas of Bayesian model averaging to average p values over SNP selections, generating posterior predictive p values, implemented in <code>coloc.bma()</code>.</p>
<p>Proportional testing, however, requires individual level genotype data, which are not always available. Claudia Giambartolomei and Vincent Plagnol have proposed an alternative method, which makes use of Jon Wakefield’s work on determining approximate Bayes Factors from p values <sup><a id="fnr.3" class="footref" href="#fn.3">3</a></sup> to generate a Bayesian colocalisation analysis <sup><a id="fnr.4" class="footref" href="#fn.4">4</a></sup>, implemented in the function <code>coloc.summaries()</code>. Note that it is possible to use Bayesian analysis for proportional testing too, in determining the posterior distribution of the proportionality constant <span class="math inline">\(\eta\)</span>.</p>
<table border="2" cellspacing="0" cellpadding="6" rules="groups" frame="hsides">
<caption class="t-above">
<span class="table-number">Table 1:</span> Suitability of functions in this package for different data structures
</caption>
<colgroup>
<col class="org-left"></col>
<col class="org-left"></col>
<col class="org-left"></col>
<col class="org-left"></col>
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">
Function
</th>
<th scope="col" class="org-left">
Approach
</th>
<th scope="col" class="org-left">
Data required
</th>
<th scope="col" class="org-left">
Dependence
</th>
</tr>
<tr>
<th scope="col" class="org-left">
 
</th>
<th scope="col" class="org-left">
 
</th>
<th scope="col" class="org-left">
 
</th>
<th scope="col" class="org-left">
between datasets
</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">
coloc.abf
</td>
<td class="org-left">
Bayesian
</td>
<td class="org-left">
summary statistics
</td>
<td class="org-left">
independent
</td>
</tr>
<tr>
<td class="org-left">
coloc.abf.datasets
</td>
<td class="org-left">
Bayesian
</td>
<td class="org-left">
raw genotypes
</td>
<td class="org-left">
independent
</td>
</tr>
<tr>
<td class="org-left">
coloc.bma
</td>
<td class="org-left">
Proportional, averages
</td>
<td class="org-left">
raw genotypes
</td>
<td class="org-left">
independent
</td>
</tr>
<tr>
<td class="org-left">
 
</td>
<td class="org-left">
over models
</td>
<td class="org-left">
 
</td>
<td class="org-left">
 
</td>
</tr>
<tr>
<td class="org-left">
coloc.pcs/coloc.test
</td>
<td class="org-left">
Proportional, based on
</td>
<td class="org-left">
raw genotypes
</td>
<td class="org-left">
independent
</td>
</tr>
<tr>
<td class="org-left">
 
</td>
<td class="org-left">
PC summary of genotypes
</td>
<td class="org-left">
 
</td>
<td class="org-left">
 
</td>
</tr>
</tbody>
</table>
<p><a id="orgfa90150"></a></p>
</div>
<div id="usage" class="section level1">
<h1>Usage</h1>
<p>Let’s simulate a small dataset, and compare the three methods.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(coloc)</code></pre></div>
<pre><code>## Registered S3 methods overwritten by 'ggplot2':
##   method         from 
##   [.quosures     rlang
##   c.quosures     rlang
##   print.quosures rlang</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setClass</span>(<span class="st">&quot;simdata&quot;</span>,
         <span class="kw">representation</span>(<span class="dt">df1=</span><span class="st">&quot;data.frame&quot;</span>,<span class="dt">df2=</span><span class="st">&quot;data.frame&quot;</span>))
<span class="kw">setValidity</span>(<span class="st">&quot;simdata&quot;</span>, <span class="cf">function</span>(object) {
  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(object<span class="op">@</span>df1)
  <span class="cf">if</span>(<span class="kw">nrow</span>(object<span class="op">@</span>df2)<span class="op">!=</span>n)
    <span class="kw">return</span>(<span class="st">&quot;nrow of '@df1' should equal nrow of '@df2'&quot;</span>)
})</code></pre></div>
<pre><code>## Class &quot;simdata&quot; [in &quot;.GlobalEnv&quot;]
## 
## Slots:
##                             
## Name:         df1        df2
## Class: data.frame data.frame</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">setMethod</span>(<span class="st">&quot;show&quot;</span>, <span class="dt">signature=</span><span class="st">&quot;simdata&quot;</span>, <span class="cf">function</span>(object) {
  <span class="kw">cat</span>(<span class="st">&quot;pair of simulated datasets, with&quot;</span>,<span class="kw">ncol</span>(object<span class="op">@</span>df1)<span class="op">-</span><span class="dv">1</span>,<span class="st">&quot;SNPs and&quot;</span>,<span class="kw">nrow</span>(object<span class="op">@</span>df1),<span class="st">&quot;samples.</span><span class="ch">\n</span><span class="st">&quot;</span>)
})

sim.data &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">nsnps=</span><span class="dv">50</span>,<span class="dt">nsamples=</span><span class="dv">200</span>,<span class="dt">causals=</span><span class="dv">1</span><span class="op">:</span><span class="dv">2</span>,<span class="dt">nsim=</span><span class="dv">1</span>) {
  <span class="kw">cat</span>(<span class="st">&quot;Generate&quot;</span>,nsim,<span class="st">&quot;small sets of data</span><span class="ch">\n</span><span class="st">&quot;</span>)
  ntotal &lt;-<span class="st"> </span>nsnps <span class="op">*</span><span class="st"> </span>nsamples <span class="op">*</span><span class="st"> </span>nsim
  X1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rbinom</span>(ntotal,<span class="dv">1</span>,<span class="fl">0.4</span>)<span class="op">+</span><span class="kw">rbinom</span>(ntotal,<span class="dv">1</span>,<span class="fl">0.4</span>),<span class="dt">ncol=</span>nsnps)
  Y1 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsamples,<span class="kw">rowSums</span>(X1[,causals]),<span class="dv">2</span>)
  X2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rbinom</span>(ntotal,<span class="dv">1</span>,<span class="fl">0.4</span>)<span class="op">+</span><span class="kw">rbinom</span>(ntotal,<span class="dv">1</span>,<span class="fl">0.4</span>),<span class="dt">ncol=</span>nsnps)
  Y2 &lt;-<span class="st"> </span><span class="kw">rnorm</span>(nsamples,<span class="kw">rowSums</span>(X2[,causals]),<span class="dv">2</span>)
  <span class="kw">colnames</span>(X1) &lt;-<span class="st"> </span><span class="kw">colnames</span>(X2) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&quot;s&quot;</span>,<span class="dv">1</span><span class="op">:</span>nsnps,<span class="dt">sep=</span><span class="st">&quot;&quot;</span>)
  df1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">Y=</span>Y1,X1)
  df2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">Y=</span>Y2,X2)
  <span class="cf">if</span>(nsim<span class="op">==</span><span class="dv">1</span>) {
    <span class="kw">return</span>(<span class="kw">new</span>(<span class="st">&quot;simdata&quot;</span>,
               <span class="dt">df1=</span><span class="kw">as.data.frame</span>(df1),
               <span class="dt">df2=</span><span class="kw">as.data.frame</span>(df2)))
  } <span class="cf">else</span> {
    index &lt;-<span class="st"> </span><span class="kw">split</span>(<span class="dv">1</span><span class="op">:</span>(nsamples <span class="op">*</span><span class="st"> </span>nsim), <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>nsim, nsamples))
    objects &lt;-<span class="st"> </span><span class="kw">lapply</span>(index, <span class="cf">function</span>(i) <span class="kw">new</span>(<span class="st">&quot;simdata&quot;</span>, <span class="dt">df1=</span><span class="kw">as.data.frame</span>(df1[i,]),
                                             <span class="dt">df2=</span><span class="kw">as.data.frame</span>(df2[i,])))
    <span class="kw">return</span>(objects)
  }
}

## simulate some data and load the coloc library
<span class="kw">set.seed</span>(<span class="dv">46411</span>)
data &lt;-<span class="st"> </span><span class="kw">sim.data</span>(<span class="dt">nsamples=</span><span class="dv">1000</span>,<span class="dt">nsim=</span><span class="dv">1</span>)</code></pre></div>
<pre><code>## Generate 1 small sets of data</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(coloc) </code></pre></div>
<p>If you are not familiar with the analysis of genetic data in R, I would suggest beginning with the <a href="http://www.bioconductor.org/packages/release/bioc/html/snpStats.html">snpStats package</a>, which has functions for reading data in a variety of formats and contains a vignette on data input. Once you have your genetic data loaded as a SnpMatrix, <code>X</code>, and phenotype information in a vector <code>Y</code>, then conversion to a <code>data.frame</code> as used above follows</p>
<pre><code>df &lt;- as.data.frame(cbind(Y=Y, as(X,&quot;numeric&quot;)))</code></pre>
<p><a id="org953546b"></a></p>
</div>
<div id="an-aside-fine-mapping-under-a-single-causal-variant-assumption" class="section level1">
<h1>An aside: fine mapping under a single causal variant assumption</h1>
<p>The Approximate Bayes Factor colocalisation analysis described in the next section essentially works by fine mapping each trait under a single causal variant assumption and then integrating over those two posterior distributions to calculate probabilities that those variants are shared. Of course, this means we can look at each trait on its own quite simply, and we can do that with the function <code>finemap.abf</code>.</p>
<p>First we analyse a single trait from our simulated data to generate summary statistics:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="kw">requireNamespace</span>(<span class="st">&quot;snpStats&quot;</span>)) {
<span class="kw">library</span>(snpStats)
Y1 &lt;-<span class="st"> </span>data<span class="op">@</span>df1<span class="op">$</span>Y
X1 &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;SnpMatrix&quot;</span>,<span class="kw">as.matrix</span>(data<span class="op">@</span>df1[,<span class="op">-</span><span class="dv">1</span>]))
p1 &lt;-<span class="st"> </span>snpStats<span class="op">::</span><span class="kw">p.value</span>(<span class="kw">single.snp.tests</span>(<span class="dt">phenotype=</span>Y1, <span class="dt">snp.data=</span>X1),<span class="dt">df=</span><span class="dv">1</span>)
maf &lt;-<span class="st"> </span><span class="kw">col.summary</span>(X1)[,<span class="st">&quot;MAF&quot;</span>]

get.beta &lt;-<span class="st"> </span><span class="cf">function</span>(...) {
   tmp &lt;-<span class="st"> </span>snpStats<span class="op">::</span><span class="kw">snp.rhs.estimates</span>(..., <span class="dt">family=</span><span class="st">&quot;gaussian&quot;</span>)
   beta &lt;-<span class="st"> </span><span class="kw">sapply</span>(tmp,<span class="st">&quot;[[&quot;</span>,<span class="st">&quot;beta&quot;</span>)
   varbeta &lt;-<span class="st"> </span><span class="kw">sapply</span>(tmp, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;Var.beta&quot;</span>)
   <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">beta=</span>beta,<span class="dt">varbeta=</span>varbeta))
}
b1 &lt;-<span class="st"> </span><span class="kw">get.beta</span>(Y1 <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">snp.data=</span>X1)
} <span class="cf">else</span> {
Y1 &lt;-<span class="st"> </span>data<span class="op">@</span>df1<span class="op">$</span>Y
X1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(data<span class="op">@</span>df1[,<span class="op">-</span><span class="dv">1</span>])
tests1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X1), <span class="cf">function</span>(i) <span class="kw">summary</span>(<span class="kw">lm</span>(Y1 <span class="op">~</span><span class="st"> </span>X1[,i]))<span class="op">$</span>coefficients[<span class="dv">2</span>,])
p1 &lt;-<span class="st"> </span><span class="kw">sapply</span>(tests1,<span class="st">&quot;[&quot;</span>,<span class="dv">4</span>)
maf &lt;-<span class="st"> </span><span class="kw">colMeans</span>(X2)<span class="op">/</span><span class="dv">2</span>

get.beta &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
   beta &lt;-<span class="st"> </span><span class="kw">sapply</span>(x,<span class="st">&quot;[&quot;</span>,<span class="dv">1</span>)
   varbeta &lt;-<span class="st"> </span><span class="kw">sapply</span>(x, <span class="st">&quot;[&quot;</span>, <span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span>
   <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">beta=</span>beta,<span class="dt">varbeta=</span>varbeta))
}
b1 &lt;-<span class="st"> </span><span class="kw">get.beta</span>(tests1)
} </code></pre></div>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Loading required package: Matrix</code></pre>
<pre><code>## coercing object of mode  numeric  to SnpMatrix</code></pre>
<p>Then we analyse them:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.res &lt;-<span class="st"> </span><span class="kw">finemap.abf</span>(<span class="dt">dataset=</span><span class="kw">list</span>(<span class="dt">beta=</span>b1<span class="op">$</span>beta, <span class="dt">varbeta=</span>b1<span class="op">$</span>varbeta, <span class="dt">N=</span><span class="kw">nrow</span>(X1),<span class="dt">sdY=</span><span class="kw">sd</span>(Y1),<span class="dt">type=</span><span class="st">&quot;quant&quot;</span>))
<span class="kw">head</span>(my.res)</code></pre></div>
<pre><code>##            V.          z.        r.      lABF.   snp prior       SNP.PP
## s1 0.03924328  5.78083831 0.7567274 11.9374068 SNP.1 1e-04 9.372547e-01
## s2 0.03880072  4.01220890 0.7588092  5.3965036 SNP.2 1e-04 1.352631e-03
## s3 0.04455547 -0.06333058 0.7326023 -0.6580400 SNP.3 1e-04 3.174860e-06
## s4 0.04602953  0.83093858 0.7261782 -0.3969407 SNP.4 1e-04 4.122100e-06
## s5 0.04237982 -1.83425483 0.7422945  0.5707526 SNP.5 1e-04 1.084882e-05
## s6 0.04495749 -0.22493863 0.7308390 -0.6377335 SNP.6 1e-04 3.239989e-06</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">tail</span>(my.res) </code></pre></div>
<pre><code>##              V.          z.        r.       lABF.    snp  prior
## s46  0.04560292 -0.00230155 0.7280258 -0.65102205 SNP.46 0.0001
## s47  0.05248414 -1.20366960 0.6993259 -0.09426528 SNP.47 0.0001
## s48  0.04101521 -0.03458088 0.7485056 -0.68971972 SNP.48 0.0001
## s49  0.04530207  0.58219760 0.7293344 -0.52983015 SNP.49 0.0001
## s50  0.04467786 -1.08347773 0.7320646 -0.22881057 SNP.50 0.0001
## s110         NA          NA        NA  0.00000000   null 0.9950
##            SNP.PP
## s46  3.197219e-06
## s47  5.579160e-06
## s48  3.075858e-06
## s49  3.609154e-06
## s50  4.876818e-06
## s110 6.100014e-02</code></pre>
<p>The <code>SNP.PP</code> column shows the posterior probability that exactly that SNP is causal. Note the last line in this data.frame does not correspond to a SNP, but to the null model, that no SNP is causal.</p>
<p>Finally, if you do have full genotype data as here, while this is a fast method for fine mapping, it can be sensible to consider multiple causal variant models too. One package that allows you to do this is <a href="http://github.com/chr1swallace/GUESSFM">GUESSFM</a>, described in<sup><a id="fnr.5" class="footref" href="#fn.5">5</a></sup></p>
<p><a id="org6973f37"></a></p>
</div>
<div id="approximate-bayes-factor-colocalisation-analyses" class="section level1">
<h1>(Approximate) Bayes Factor colocalisation analyses</h1>
<p><a id="org192e16b"></a></p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>The idea behind the ABF analysis is that the association of each trait with SNPs in a region may be summarised by a vector of 0s and at most a single 1, with the 1 indicating the causal SNP (so, assuming a single causal SNP for each trait). The posterior probability of each possible configuration can be calculated and so, crucially, can the posterior probabilities that the traits share their configurations. This allows us to estimate the support for the following cases:</p>
<ul>
<li><span class="math inline">\(H_0\)</span>: neither trait has a genetic association in the region</li>
<li><span class="math inline">\(H_1\)</span>: only trait 1 has a genetic association in the region</li>
<li><span class="math inline">\(H_2\)</span>: only trait 2 has a genetic association in the region</li>
<li><span class="math inline">\(H_3\)</span>: both traits are associated, but with different causal variants</li>
<li><span class="math inline">\(H_4\)</span>: both traits are associated and share a single causal variant</li>
</ul>
<p><a id="orgb0fa807"></a></p>
</div>
<div id="the-basic-coloc.abf-function" class="section level2">
<h2>The basic <code>coloc.abf</code> function</h2>
<p>The function <code>coloc.abf</code> is ideally suited to the case when only summary data are available, and requires, for each trait, either:</p>
<ul>
<li>p values for each SNP</li>
<li>each SNP’s minor allele frequency</li>
<li>sample size</li>
<li>ratio of cases:controls (if using a case-control trait)</li>
</ul>
<p>or:</p>
<ul>
<li>regression coefficients for each SNP</li>
<li>variance of these regression coefficients.</li>
</ul>
<p>If regression coefficients and their variance are available, please use these, but we can also approximate Bayes Factors from p values and minor allele frequencies, although, note, such approximation can be less accurate when imputed data are used. NB, you can mix and match, depending on the data available from each study.</p>
<p>A wrapper function is avalailable to run all these steps but we will first generate the p values manually to give all the details. We use the snpStats library from Bioconductor to calculate the p values quickly. We will also calculate the coefficients and their standard errors to compare the two approaches (but you should use only one - the coefficients if available, otherwise the p values).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="cf">if</span>(<span class="kw">requireNamespace</span>(<span class="st">&quot;snpStats&quot;</span>)) {
<span class="kw">library</span>(snpStats)

Y1 &lt;-<span class="st"> </span>data<span class="op">@</span>df1<span class="op">$</span>Y
Y2 &lt;-<span class="st"> </span>data<span class="op">@</span>df2<span class="op">$</span>Y

X1 &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;SnpMatrix&quot;</span>,<span class="kw">as.matrix</span>(data<span class="op">@</span>df1[,<span class="op">-</span><span class="dv">1</span>]))
X2 &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">&quot;SnpMatrix&quot;</span>,<span class="kw">as.matrix</span>(data<span class="op">@</span>df2[,<span class="op">-</span><span class="dv">1</span>]))

p1 &lt;-<span class="st"> </span>snpStats<span class="op">::</span><span class="kw">p.value</span>(<span class="kw">single.snp.tests</span>(<span class="dt">phenotype=</span>Y1, <span class="dt">snp.data=</span>X1),<span class="dt">df=</span><span class="dv">1</span>)
p2 &lt;-<span class="st"> </span>snpStats<span class="op">::</span><span class="kw">p.value</span>(<span class="kw">single.snp.tests</span>(<span class="dt">phenotype=</span>Y2, <span class="dt">snp.data=</span>X2),<span class="dt">df=</span><span class="dv">1</span>)

maf &lt;-<span class="st"> </span><span class="kw">col.summary</span>(X2)[,<span class="st">&quot;MAF&quot;</span>]

get.beta &lt;-<span class="st"> </span><span class="cf">function</span>(...) {
   tmp &lt;-<span class="st"> </span>snpStats<span class="op">::</span><span class="kw">snp.rhs.estimates</span>(..., <span class="dt">family=</span><span class="st">&quot;gaussian&quot;</span>)
   beta &lt;-<span class="st"> </span><span class="kw">sapply</span>(tmp,<span class="st">&quot;[[&quot;</span>,<span class="st">&quot;beta&quot;</span>)
   varbeta &lt;-<span class="st"> </span><span class="kw">sapply</span>(tmp, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;Var.beta&quot;</span>)
   <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">beta=</span>beta,<span class="dt">varbeta=</span>varbeta))
}
b1 &lt;-<span class="st"> </span><span class="kw">get.beta</span>(Y1 <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">snp.data=</span>X1)
b2 &lt;-<span class="st"> </span><span class="kw">get.beta</span>(Y2 <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">snp.data=</span>X2)
} <span class="cf">else</span> {
Y1 &lt;-<span class="st"> </span>data<span class="op">@</span>df1<span class="op">$</span>Y
Y2 &lt;-<span class="st"> </span>data<span class="op">@</span>df2<span class="op">$</span>Y

X1 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(data<span class="op">@</span>df1[,<span class="op">-</span><span class="dv">1</span>])
X2 &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(data<span class="op">@</span>df2[,<span class="op">-</span><span class="dv">1</span>])

tests1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X1), <span class="cf">function</span>(i) <span class="kw">summary</span>(<span class="kw">lm</span>(Y1 <span class="op">~</span><span class="st"> </span>X1[,i]))<span class="op">$</span>coefficients[<span class="dv">2</span>,])
tests2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(X2), <span class="cf">function</span>(i) <span class="kw">summary</span>(<span class="kw">lm</span>(Y2 <span class="op">~</span><span class="st"> </span>X2[,i]))<span class="op">$</span>coefficients[<span class="dv">2</span>,])

p1 &lt;-<span class="st"> </span><span class="kw">sapply</span>(tests1,<span class="st">&quot;[&quot;</span>,<span class="dv">4</span>)
p2 &lt;-<span class="st"> </span><span class="kw">sapply</span>(tests2,<span class="st">&quot;[&quot;</span>,<span class="dv">4</span>)

maf &lt;-<span class="st"> </span><span class="kw">colMeans</span>(X2)<span class="op">/</span><span class="dv">2</span>

get.beta &lt;-<span class="st"> </span><span class="cf">function</span>(x) {
   beta &lt;-<span class="st"> </span><span class="kw">sapply</span>(x,<span class="st">&quot;[&quot;</span>,<span class="dv">1</span>)
   varbeta &lt;-<span class="st"> </span><span class="kw">sapply</span>(x, <span class="st">&quot;[&quot;</span>, <span class="dv">2</span>)<span class="op">^</span><span class="dv">2</span>
   <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">beta=</span>beta,<span class="dt">varbeta=</span>varbeta))
}
b1 &lt;-<span class="st"> </span><span class="kw">get.beta</span>(tests1)
b2 &lt;-<span class="st"> </span><span class="kw">get.beta</span>(tests2)
} </code></pre></div>
<pre><code>## coercing object of mode  numeric  to SnpMatrix
## coercing object of mode  numeric  to SnpMatrix</code></pre>
<p>Note that we are using the second dataset in that case to compute the minor allele frequencies. This is unlikely to make any significant difference but one could have used dataset 1 instead. It is now possible to compute the probabilities of interest.</p>
<p>With coefficients, and std. deviation of Y known, we have the most accurate inference. Note that if you have a case-control trait, set type=“cc” and supply s, the proportion of samples in the dataset that are cases (from which sdY can be derived), instead of giving sdY directly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.res &lt;-<span class="st"> </span><span class="kw">coloc.abf</span>(<span class="dt">dataset1=</span><span class="kw">list</span>(<span class="dt">beta=</span>b1<span class="op">$</span>beta, <span class="dt">varbeta=</span>b1<span class="op">$</span>varbeta, <span class="dt">N=</span><span class="kw">nrow</span>(X1),<span class="dt">sdY=</span><span class="kw">sd</span>(Y1),<span class="dt">type=</span><span class="st">&quot;quant&quot;</span>),
                    <span class="dt">dataset2=</span><span class="kw">list</span>(<span class="dt">beta=</span>b2<span class="op">$</span>beta, <span class="dt">varbeta=</span>b2<span class="op">$</span>varbeta, <span class="dt">N=</span><span class="kw">nrow</span>(X2),<span class="dt">sdY=</span><span class="kw">sd</span>(Y2),<span class="dt">type=</span><span class="st">&quot;quant&quot;</span>),
                    <span class="dt">MAF=</span>maf)</code></pre></div>
<pre><code>## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf 
##  2.92e-05  4.47e-04  6.73e-05  3.08e-05  9.99e-01 
## [1] &quot;PP abf for shared variant: 99.9%&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(my.res[[<span class="dv">1</span>]]) </code></pre></div>
<pre><code>##        nsnps    PP.H0.abf    PP.H1.abf    PP.H2.abf    PP.H3.abf 
## 5.000000e+01 2.915837e-05 4.466024e-04 6.726224e-05 3.079177e-05 
##    PP.H4.abf 
## 9.994262e-01</code></pre>
<p>When std. deviation of Y is unknown, coloc will try and estimate sdY from variance of beta and MAF, but this can be noisy, particularly for small datasets, and will produce a warning:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.res &lt;-<span class="st"> </span><span class="kw">coloc.abf</span>(<span class="dt">dataset1=</span><span class="kw">list</span>(<span class="dt">beta=</span>b1<span class="op">$</span>beta, <span class="dt">varbeta=</span>b1<span class="op">$</span>varbeta, <span class="dt">N=</span><span class="kw">nrow</span>(X1),<span class="dt">type=</span><span class="st">&quot;quant&quot;</span>),
                    <span class="dt">dataset2=</span><span class="kw">list</span>(<span class="dt">beta=</span>b2<span class="op">$</span>beta, <span class="dt">varbeta=</span>b2<span class="op">$</span>varbeta, <span class="dt">N=</span><span class="kw">nrow</span>(X2),<span class="dt">type=</span><span class="st">&quot;quant&quot;</span>),
                    <span class="dt">MAF=</span>maf)</code></pre></div>
<pre><code>## Warning in sdY.est(d$varbeta, d$MAF, d$N): estimating sdY from maf and
## varbeta, please directly supply sdY if known

## Warning in sdY.est(d$varbeta, d$MAF, d$N): estimating sdY from maf and
## varbeta, please directly supply sdY if known</code></pre>
<pre><code>## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf 
##  2.54e-06  1.48e-04  1.75e-05  2.00e-05  1.00e+00 
## [1] &quot;PP abf for shared variant: 100%&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(my.res[[<span class="dv">1</span>]]) </code></pre></div>
<pre><code>##        nsnps    PP.H0.abf    PP.H1.abf    PP.H2.abf    PP.H3.abf 
## 5.000000e+01 2.535953e-06 1.476540e-04 1.751478e-05 1.997285e-05 
##    PP.H4.abf 
## 9.998123e-01</code></pre>
<p>When only p values are available, we can use the form:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.res &lt;-<span class="st"> </span><span class="kw">coloc.abf</span>(<span class="dt">dataset1=</span><span class="kw">list</span>(<span class="dt">pvalues=</span>p1,<span class="dt">N=</span><span class="kw">nrow</span>(X1),<span class="dt">type=</span><span class="st">&quot;quant&quot;</span>),
                    <span class="dt">dataset2=</span><span class="kw">list</span>(<span class="dt">pvalues=</span>p2,<span class="dt">N=</span><span class="kw">nrow</span>(X2),<span class="dt">type=</span><span class="st">&quot;quant&quot;</span>),
                    <span class="dt">MAF=</span>maf)</code></pre></div>
<pre><code>## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf 
##  1.01e-05  2.61e-04  4.00e-05  2.71e-05  1.00e+00 
## [1] &quot;PP abf for shared variant: 100%&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(my.res[[<span class="dv">1</span>]]) </code></pre></div>
<pre><code>##        nsnps    PP.H0.abf    PP.H1.abf    PP.H2.abf    PP.H3.abf 
## 5.000000e+01 1.014723e-05 2.605269e-04 3.998959e-05 2.705757e-05 
##    PP.H4.abf 
## 9.996623e-01</code></pre>
<p>Here, as we have simulated full genotype data in snpStats format, we can use the wrapper function <code>coloc.abf.datasets()</code> to combine all the steps shown above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ct.abf &lt;-<span class="st"> </span><span class="kw">coloc.abf.datasets</span>(data<span class="op">@</span>df1, data<span class="op">@</span>df2, <span class="dt">response1=</span><span class="st">&quot;Y&quot;</span>, <span class="dt">response2=</span><span class="st">&quot;Y&quot;</span>,
                             <span class="dt">type1=</span><span class="st">&quot;quant&quot;</span>, <span class="dt">type2=</span><span class="st">&quot;quant&quot;</span>) </code></pre></div>
<pre><code>## coercing object of mode  numeric  to SnpMatrix
## coercing object of mode  numeric  to SnpMatrix
## PP.H0.abf PP.H1.abf PP.H2.abf PP.H3.abf PP.H4.abf 
##  1.08e-05  2.61e-04  4.25e-05  2.72e-05  1.00e+00 
## [1] &quot;PP abf for shared variant: 100%&quot;</code></pre>
<p><a id="org3e7ddb9"></a></p>
</div>
</div>
<div id="proportional-testing" class="section level1">
<h1>Proportional testing</h1>
<p>The code below first prepares a principal component object by combining the genotypes in the two dataset, then models the most informative components (the minimum set required to capture 80% of the genetic variation) in each dataset, before finally testing whether there is colocalisation between these models.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## run a coloc with pcs
pcs &lt;-<span class="st"> </span><span class="kw">pcs.prepare</span>(data<span class="op">@</span>df1[,<span class="op">-</span><span class="dv">1</span>], data<span class="op">@</span>df2[,<span class="op">-</span><span class="dv">1</span>])
pcs<span class="fl">.1</span> &lt;-<span class="st"> </span><span class="kw">pcs.model</span>(pcs, <span class="dt">group=</span><span class="dv">1</span>, <span class="dt">Y=</span>data<span class="op">@</span>df1[,<span class="dv">1</span>], <span class="dt">threshold=</span><span class="fl">0.8</span>)</code></pre></div>
<pre><code>## selecting 38 components out of 50 to capture 0.8094953 of total variance.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pcs<span class="fl">.2</span> &lt;-<span class="st"> </span><span class="kw">pcs.model</span>(pcs, <span class="dt">group=</span><span class="dv">2</span>, <span class="dt">Y=</span>data<span class="op">@</span>df2[,<span class="dv">1</span>], <span class="dt">threshold=</span><span class="fl">0.8</span>)</code></pre></div>
<pre><code>## selecting 38 components out of 50 to capture 0.8094953 of total variance.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ct.pcs &lt;-<span class="st"> </span><span class="kw">coloc.test</span>(pcs<span class="fl">.1</span>,pcs<span class="fl">.2</span>) </code></pre></div>
<p>The plot shows the estimated coefficients for each principal component modeled for traits 1 and 2 on the x and y axes, with circles showing the 95% confidence region. The points lie close to the line through the origin, which supports a hypothesis of colocalisation.</p>
<p>A little more information is stored in the <code>ct.pcs</code> object:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ct.pcs</code></pre></div>
<pre><code>##           eta.hat         chisquare                 n p.value.chisquare 
##         1.0346897        35.3484010        38.0000000         0.5465861</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(<span class="kw">summary</span>(ct.pcs)) </code></pre></div>
<pre><code>##           eta.hat         chisquare                 n p.value.chisquare 
##         1.0346897        35.3484010        38.0000000         0.5465861 
##  Named num [1:4] 1.035 35.348 38 0.547
##  - attr(*, &quot;names&quot;)= chr [1:4] &quot;eta.hat&quot; &quot;chisquare&quot; &quot;n&quot; &quot;p.value.chisquare&quot;</code></pre>
<p>The best estimate for the coefficient of proportionality, <span class="math inline">\(\hat{\eta}\)</span>, is 1.13, and the null hypothesis of colocalisation is not rejected with a chisquare statistic of 5.27 based on 7 degrees of freedom (<span class="math inline">\(n-1\)</span> where the <span class="math inline">\(n\)</span> is the number of components tested, and one degree of freedom was used in estimating <span class="math inline">\(\eta\)</span>), giving a p value of 0.63. The <code>summary()</code> method returns a named vector of length 4 containing this information.</p>
<p>If more information is needed about <span class="math inline">\(\eta\)</span>, then this is available if the <code>bayes</code> argument is supplied:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ct.pcs.bayes &lt;-<span class="st"> </span><span class="kw">coloc.test</span>(pcs<span class="fl">.1</span>,pcs<span class="fl">.2</span>, <span class="dt">bayes=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## ............</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ci</span>(ct.pcs.bayes) </code></pre></div>
<pre><code>## $eta.mode
## [1] 1.039993
## 
## $lower
## [1] 0.8445606
## 
## $upper
## [1] 1.274574
## 
## $level.observed
## [1] 0.9390264
## 
## $interior
## [1] TRUE</code></pre>
<p><a id="orgb852386"></a></p>
<div id="using-bayes-factors-to-compare-specific-values-of-eta" class="section level2">
<h2>Using Bayes Factors to compare specific values of <span class="math inline">\(\eta\)</span></h2>
<p>It may be that specific values of <span class="math inline">\(\eta\)</span> are of interest. For example, when comparing eQTLs in two tissues, or when comparing risk of two related diseases, the value <span class="math inline">\(\eta=1\)</span> is of particular interest. In proportional testing, we can use Bayes Factors to compare the support for different values of <span class="math inline">\(\eta\)</span>. Eg</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## compare individual values of eta
ct.pcs &lt;-<span class="st"> </span><span class="kw">coloc.test</span>(pcs<span class="fl">.1</span>,pcs<span class="fl">.2</span>, <span class="dt">bayes.factor=</span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>))</code></pre></div>
<pre><code>## ............</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bf</span>(ct.pcs)</code></pre></div>
<pre><code>##           values.against
## values.for           -1            0            1
##         -1 1.000000e+00 4.495343e-33 9.816601e-73
##         0  2.224524e+32 1.000000e+00 2.183727e-40
##         1  1.018683e+72 4.579328e+39 1.000000e+00</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## compare ranges of eta
ct.bma &lt;-<span class="st"> </span><span class="kw">coloc.bma</span>(data<span class="op">@</span>df1, data<span class="op">@</span>df2, 
                    <span class="dt">family1=</span><span class="st">&quot;gaussian&quot;</span>, <span class="dt">family2=</span><span class="st">&quot;gaussian&quot;</span>,
                    <span class="dt">bayes.factor=</span><span class="kw">list</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">0.1</span>,<span class="dv">1</span>), <span class="kw">c</span>(<span class="fl">0.9</span>,<span class="fl">1.1</span>)))</code></pre></div>
<pre><code>## Dropped 0 of 50 SNPs due to LD: r2 &gt; 0.95.</code></pre>
<pre><code>## 50 SNPs remain.</code></pre>
<pre><code>## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.</code></pre>
<pre><code>## Restricting model space.</code></pre>
<pre><code>## 48 SNPs have single SNP posterior probabilities &lt; 0.01</code></pre>
<pre><code>## Models containing only these SNPs will not be explored.</code></pre>
<pre><code>## Fitting 97 multi SNP models to dataset 1</code></pre>
<pre><code>## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.</code></pre>
<pre><code>## Fitting 97 multi SNP models to dataset 2</code></pre>
<pre><code>## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.

## Warning in E1ot$app1 - E0ot$app1: Recycling array of length 1 in vector-array arithmetic is deprecated.
##   Use c() or as.vector() instead.</code></pre>
<pre><code>## Averaging coloc testing over 3 models with posterior probabilities &gt;= 1e-229 
## ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">bf</span>(ct.bma) </code></pre></div>
<pre><code>##              values.against
## values.for    c(-0.1, 1) c(0.9, 1.1)
##   c(-0.1, 1)     1.00000  0.08537724
##   c(0.9, 1.1)   11.71272  1.00000000</code></pre>
<p><a id="org6244015"></a></p>
</div>
</div>
<div id="the-difference-between-proportional-and-abf-approaches" class="section level1">
<h1>The difference between proportional and ABF approaches</h1>
<p>So what are the differences between proportional and ABF approaches? Which should you choose?</p>
<p>Well, if you only have p values, then you must use ABF. But be aware that a single causal variant is assumed, and that for accurate inference, the causal variant needs to be included, so either very dense or imputed genotyping data is needed. The ABF approach has another big advantage over proportional testing: being Bayesian, it allows you to evaluate support for each hypothesis, whereas with proportional testing, when the null of colocalisation is not rejected, you cannot be sure whether this reflects true colocalisation or a lack of power. The proportional approach is much less affected by spareness of genotyping data, with power only slightly decreased, but type 1 error rates unaffected.</p>
<p>The behaviour of the two approaches only really differs when there are two or more causal variants. When both are shared, proportional testing has the same type 1 error rate, and whilst ABF tends to still favour <span class="math inline">\(H_4\)</span> (shared variant), it tends to put some more weight on <span class="math inline">\(H_3\)</span> (distinct variants). But when at least one is specific to one trait and at least one is shared, their behaviour differs more substantially. Of course, neither approach was designed with this case in mind, and so there is no “right” answer, but it is instructive to understand their expected behaviour. Proportional testing tends to reject colocalisation, whilst ABF tends to favour sharing. Until the methods are extended to incorporate this specific case, it can be useful to compare the two approaches when complete and dense genotyping data are available. When the results differ, we have tended to identify a combination of shared and distinct causal variants. The ABF approach can still be applied in this case, if p values are available conditioning on the strongest signal, as demonstrated in our paper <sup><a id="fnr.4.100" class="footref" href="#fn.4">4</a></sup>.</p>
<p>You can see more about the ABF approach on <a href="http://haldanessieve.org/2013/05/21/our-paper-bayesian-test-for-co-localisation-between-pairs-of-genetic-association-studies-using-summary-statistics/">this blogpost</a>.</p>
</div>
<div id="footnotes" class="section level1">
<h1>Footnotes</h1>
<p><sup><a id="fn.1" href="#fnr.1">1</a></sup> <a href="http://www.ncbi.nlm.nih.gov/pubmed/19039033" class="uri">http://www.ncbi.nlm.nih.gov/pubmed/19039033</a></p>
<p><sup><a id="fn.2" href="#fnr.2">2</a></sup> <a href="http://onlinelibrary.wiley.com/doi/10.1002/gepi.21765/abstract" class="uri">http://onlinelibrary.wiley.com/doi/10.1002/gepi.21765/abstract</a></p>
<p><sup><a id="fn.3" href="#fnr.3">3</a></sup> <a href="http://www.ncbi.nlm.nih.gov/pubmed/18642345" class="uri">http://www.ncbi.nlm.nih.gov/pubmed/18642345</a></p>
<p><sup><a id="fn.4" href="#fnr.4">4</a></sup> <a href="http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1004383" class="uri">http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1004383</a></p>
<p><sup><a id="fn.5" href="#fnr.5">5</a></sup> <a href="http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1005272" class="uri">http://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1005272</a></p>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
